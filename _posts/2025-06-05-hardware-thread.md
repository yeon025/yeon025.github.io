---
title: "하드웨어 스레드"
author: 
date: 2025-06-05 16:35:00 +0900
categories: [Computer Architecture]
---
![danawa](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FUP2Cn%2FbtsOolvQmrh%2FNmhCjqWuZZKVk2r5bbCFcK%2Fimg.png)
[[컴퓨터 구조]CPU 코어](https://yeon025.github.io/posts/cpu-core/) 에서는 `8Core 16Thread`의 Core에 대해 설명했습니다.
이번 글은 Thread에 대해 설명하려고 합니다.

<br>
<br>

## 하드웨어 스레드
---
하드웨어 스레드는 각각 독립적인 레지스터를 가지고 있어, 자신만의 명령어 흐름을 유지할 수 있도록 상태를 보존하는 단위입니다.<br>

여기서 “자신만의 명령어 흐름을 유지할 수 있도록 상태를 보존한다”는 말을 조금 더 자세히 설명하겠습니다.
예를 들어, 하드웨어 스레드 1의 레지스터에는 eax = 2, ebx = 3이 있고, 하드웨어 스레드 2의 레지스터에는 eax = 5, ebx = 7이 있다고 가정해 봅시다.
이때 `add eax, ebx` 명령어를 실행하면, 두 하드웨어 스레드는 서로 다른 결과를 얻게 됩니다.

* 하드웨어 스레드 1은 eax = 2 + 3 = 5가 되고
* 하드웨어 스레드 2는 eax = 5 + 7 = 12가 됩니다.

즉, 각각의 하드웨어 스레드는 자신의 레지스터 값을 바탕으로 연산하기 때문에 결과가 달라집니다.
이처럼 하드웨어 스레드는 각자 독립된 상태를 유지하여 서로 영향을 주지 않고, 별개의 명령어 흐름을 따라 실행된다는 의미입니다.

<br>
<br>

## 하이퍼스레딩
---
하이퍼스레딩(Hyper-Threading)은 하나의 물리적 CPU 코어가 두 개의 하드웨어 스레드를 제공하여, 한 스레드가 대기 상태일 때 다른 스레드의 명령어를 실행하는 기술입니다.

하드웨어 스레드는 다음과 같이 자원을 구분하여 가집니다.
* 독립적인 자원 : 레지스터 세트<br>
    * 각 스레드는 별도의 레지스터 세트를 보유하여 독립적인 실행 흐름을 유지할 수 있습니다.
* 공유 자원 : ALU, 캐시, 제어 장치 등 핵심 실행 자원
    * 이러한 자원들은 여러 하드웨어 스레드가 함께 공유하여 사용합니다.

이러한 구조 덕분에 하나의 스레드가 대기할 때, 다른 스레드가 공유 자원을 사용하여 유휴 시간(사용되고 있지 않는 시간)을 줄이고 자원 활용률을 높일 수 있습니다.

단, 공유 자원이 있기 때문에 항상 성능이 두 배로 증가하지는 않고, 작업 부하에 따라 효율이 달라집니다.

<br>

### 하이퍼스레딩의 작동 과정
1. 프로그램이 L1/L2 캐시에 없는 데이터를 메인 메모리에서 불러오거나, 디스크·네트워크 등 외부 장치와 데이터를 주고받는 상황이 발생합니다.

2. 이때 CPU는 해당 작업이 완료될 때까지 대기해야 하며, 현재 실행 중인 하드웨어 스레드는 ALU 등의 실행 자원을 사용할 수 없습니다.

3. 하드웨어 스레드 1은 자신의 명령어 포인터(EIP/RIP)가 가리키는 다음 명령어를 실행하지 못하고 정지하게 됩니다.

4. CPU는 유휴 상태인 공유 자원을 활용하기 위해, 하드웨어 스레드 2의 명령어 포인터가 가리키는 명령어를 대신 실행합니다.

5. 이 과정에서 하드웨어 스레드 2는 ALU 등의 공유 자원을 활용하여 CPU의 유휴 시간을 줄이고, 전체적인 처리 효율을 높이게 됩니다.

<br>

### 작업 관리자로 본 하이퍼스레딩
![task_manager_cpu](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FzVxXx%2FbtsOtf09qDz%2FJkXA1oYB9qTw2lcmCipmS1%2Fimg.png)
사진을 보면 총 4개의 코어가 있고, 각 코어당 2개의 하드웨어 스레드가 동작해 총 8개의 스레드가 실행 중입니다.<br>
작업 관리자에서는 이들을 각각 하나의 CPU 그래프로 표시하며, 서로 다른 사용률을 통해 각 스레드가 독립적인 작업을 수행하고 있음을 보여줍니다.